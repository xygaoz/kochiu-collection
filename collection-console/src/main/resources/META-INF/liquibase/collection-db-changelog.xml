<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.19.xsd">

    <changeSet author="kochiu" id="kcdb_1" runOnChange="true" dbms="sqlite">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="sys_role"/>
            </not>
        </preConditions>
        <createTable remarks="系统角色表" tableName="sys_role">
            <column name="ROLE_ID" remarks="主键" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="ROLE_NAME" remarks="角色名称" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="CREATE_TIME" remarks="创建时间" type="date"/>
            <column name="CREATE_BY" remarks="创建人" type="VARCHAR(20)"/>
            <column name="UPDATE_TIME" remarks="更新时间" type="date"/>
            <column name="UPDATE_BY" remarks="更新人" type="VARCHAR(20)"/>
            <column name="DB_VERSION" remarks="数据版本" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <!-- 添加主键自增元数据 -->
        <addAutoIncrement
                tableName="sys_role"
                columnName="ROLE_ID"
                columnDataType="INTEGER"
        />
    </changeSet>

    <changeSet id="kcdb_2" author="kochiu" runOnChange="true">
        <preConditions>
            <not>
                <indexExists tableName="sys_role" indexName="IDX_ROLE_NAME"/>
            </not>
        </preConditions>
        <createIndex tableName="sys_role" indexName="IDX_ROLE_NAME" unique="true">
            <column name="ROLE_NAME"/>
        </createIndex>
    </changeSet>

    <changeSet id="kcdb_3" author="kochiu" runOnChange="true">
        <preConditions>
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM sys_role
                WHERE role_id = 1
            </sqlCheck>
        </preConditions>
        <insert tableName="sys_role">
            <column name="ROLE_ID" value="1"/>
            <column name="ROLE_NAME" value="超级管理员"/>
            <column name="CREATE_TIME" valueComputed="datetime('now')"/>
            <column name="CREATE_BY" value="sys"/>
            <column name="DB_VERSION" value="1"/>
        </insert>
    </changeSet>

    <changeSet author="kochiu" id="kcdb_4" runOnChange="true" dbms="sqlite">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="sys_user"/>
            </not>
        </preConditions>
        <createTable remarks="系统用户表" tableName="sys_user">
            <column name="USER_ID" remarks="主键" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="USER_CODE" remarks="用户编码" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="PASSWORD" remarks="密码" type="VARCHAR(200)">
                <constraints nullable="false"/>
            </column>
            <column name="USER_NAME" remarks="用户名称" type="VARCHAR(20)">
                <constraints nullable="false"/>
            </column>
            <column name="TOKEN" remarks="token" type="VARCHAR(200)"/>
            <column name="KEY" remarks="加密key" type="VARCHAR(100)"/>
            <column name="CREATE_TIME" remarks="创建时间" type="date"/>
            <column name="CREATE_BY" remarks="创建人" type="VARCHAR(20)"/>
            <column name="UPDATE_TIME" remarks="更新时间" type="date"/>
            <column name="UPDATE_BY" remarks="更新人" type="VARCHAR(20)"/>
            <column name="DB_VERSION" remarks="数据版本" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- 添加主键自增元数据 -->
        <addAutoIncrement
                tableName="sys_user"
                columnName="USER_ID"
                columnDataType="INTEGER"
        />
    </changeSet>

    <changeSet id="kcdb_5" author="kochiu" runOnChange="true">
        <preConditions>
            <not>
                <indexExists tableName="sys_user" indexName="IDX_USER_CODE"/>
            </not>
        </preConditions>
        <createIndex tableName="sys_user" indexName="IDX_USER_CODE" unique="true">
            <column name="USER_CODE"/>
        </createIndex>
    </changeSet>

    <changeSet id="kcdb_6" author="kochiu" runOnChange="true">
        <preConditions>
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM sys_user
                WHERE user_id = 1
            </sqlCheck>
        </preConditions>
        <insert tableName="sys_user">
            <column name="USER_ID" value="1"/>
            <column name="USER_CODE" value="admin"/>
            <column name="USER_NAME" value="超级管理员"/>
            <!-- 34A7FBD62115828DB20486FE2416DB8876C52904272209B9E8600D0041449E2EC12D6A47334D8265CF66E7672D58EE838D8F718117C809457B524E7CFFA249B28F80BCD7AD89268533DF8F94387FC033BFC34BAD61D9C53D21A71EC10C4E3ECC66AB5BD1B299823E618B06A22865929FCAEDF0B7B57479DF7FEE60F8FE85F8DDFE03D0A83C1872E14150C88B24A89213CEA2B625D5CC9B499C7461E0E247EA19A60FE83F266B385E594D549AB76A32193648E1C6F73DECB81430081D915ABBC96E053E7B15E82881E5D32B88F64EE5C1DC2524EDDC818AC6BFEC9028DB15B136D2E6AE4619E4FDF17187E4A94DD802C864247B26ED426CD58EC615EC85180D59 -->
            <column name="PASSWORD" value="d2b8afb55b37b72eeef30cf7421957cf5b32f2966dfc2bf47231aafef594360f"/>
            <column name="KEY" value="Gs^4@*3xvhT"/>
            <column name="CREATE_TIME" valueComputed="datetime('now')"/>
            <column name="CREATE_BY" value="sys"/>
            <column name="DB_VERSION" value="1"/>
        </insert>
    </changeSet>

    <changeSet author="kochiu" id="kcdb_7" runOnChange="true" dbms="sqlite">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="sys_security"/>
            </not>
        </preConditions>
        <createTable remarks="系统密钥表" tableName="sys_security">
            <column name="ID" remarks="主键" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="PUBLIC_KEY" remarks="公钥" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="PRIVATE_KEY" remarks="私钥" type="VARCHAR(200)">
                <constraints nullable="false"/>
            </column>
            <column name="COMMON_KEY" remarks="公用加密key" type="VARCHAR(30)">
                <constraints nullable="false"/>
            </column>
            <column name="CREATE_TIME" remarks="创建时间" type="date"/>
            <column name="CREATE_BY" remarks="创建人" type="VARCHAR(20)"/>
            <column name="UPDATE_TIME" remarks="更新时间" type="date"/>
            <column name="UPDATE_BY" remarks="更新人" type="VARCHAR(20)"/>
            <column name="DB_VERSION" remarks="数据版本" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- 添加主键自增元数据 -->
        <addAutoIncrement
                tableName="sys_security"
                columnName="ID"
                columnDataType="INTEGER"
        />
    </changeSet>

    <changeSet id="kcdb_8" author="kochiu" runOnChange="true">
        <preConditions>
            <rowCount expectedRows="0" tableName="sys_security"/>
        </preConditions>
        <insert tableName="sys_security">
            <column name="PUBLIC_KEY" value="85443E610DE35EBBABED852F6FB59E0E8EC023652E2750154800319568AEA85F5E84E62B8EB4DD687556E1DDF6C606922C37475C3902B2A0D726F49B717ED103EDBE56DC0099D63E817641FF4E09CFC36F84FFAA48392E6EE16F8F2FD8EFAB83CF788460D6752D10170DFE76597D4B428C8FF645120B0F1C1161C3AA765AE8C7FF6C4F77E8D7E42F7B82F4C314B979B1801C29A495EC614884765C8718B1C709040570EB03DDFDD15074F0437EDC963AFB7350F83E57F514606E4F9FF44ADF2B58CEC32A0B717919754E7F992A47AD3D7F16F950044BF9AF4FBF069FBA4596DE6A7C9D0B2FEE4256F0D65170D0ACD5706EF40C482C9766A55257348D1F601FED"/>
            <column name="PRIVATE_KEY" value="308204BD020100300D06092A864886F70D0101010500048204A7308204A3020100028201010085443E610DE35EBBABED852F6FB59E0E8EC023652E2750154800319568AEA85F5E84E62B8EB4DD687556E1DDF6C606922C37475C3902B2A0D726F49B717ED103EDBE56DC0099D63E817641FF4E09CFC36F84FFAA48392E6EE16F8F2FD8EFAB83CF788460D6752D10170DFE76597D4B428C8FF645120B0F1C1161C3AA765AE8C7FF6C4F77E8D7E42F7B82F4C314B979B1801C29A495EC614884765C8718B1C709040570EB03DDFDD15074F0437EDC963AFB7350F83E57F514606E4F9FF44ADF2B58CEC32A0B717919754E7F992A47AD3D7F16F950044BF9AF4FBF069FBA4596DE6A7C9D0B2FEE4256F0D65170D0ACD5706EF40C482C9766A55257348D1F601FED02030100010282010064B25C3019BE64268A92BEC0493882659D97B12712E8C1AA52ED528A02BF769A1961724A175AB2B1EB77EAD33D5404430F05F5F5C95E307B3817475CED3555DA121A70A76C0CD1C6092CC2519735F2B749DCC51275E03F25A952126FA50BF41D74F72B8FC07C69C06EAB344B58F3439AD57B322A9EA79C9328CF2679F75459EF21E6413795B9DE8D7BE7A6FCA3DAB62CC4DD52EA21A84CD99EF3F8DF078F22AA92E336211720595E0D4BDE0A64EE614EECA079203D527F24CF2281F392FDA0CE6F57C39D7942C0064B963482E34DAF16FC24D691492B7CA044A6BC833892EE6E4F59AA9AFDFFF2EB5A17E67E338AADAAFDDA882B3AB2719211C041616EEF640102818100F7AD370F887FB4D324D492A5C2BD54CC72F14A3238211AA85886A337BE675F9BEAA084FFFBCD2B83119199E91F1B10D13B33DA7373EC9EDEB7C10A0DEC4DEA4EBC068F978002B83B7B01932ABDFB920193E1A1BA05BA1C9811F9DBFD2E4EB19008BF5E365AD0309F55D0D8F6134DD4510CC0821D6E8329A1FA00F45FC64DDA9D0281810089BEBF9580986E84271813ADEE5BF53677BBD49299EA22CCF10E73FAE64097447537E0E5171CBAD2B81876BE9BADA3343EE2E04E6A0B136BED9F5EC44BB986604ADCF28838B7A8C02401A73C4207071C43918DE5BB6C32E31FF4F820BDF981A11B7949258454FC911384D8E47AA85D914DD33ABB4FD54FEE66B796C5206871910281800B39645765DE33B9A5DFA44DB2C795C2362B4D2B7D73B29B9277778A1D2CDE1E58C1B1855049FA00D498FE9A9BF84408D76000345F3A87F09BEF399F6BE81408416922B4C0EE5E9F03720CD3510CC78F1EBE88EFBF36B1F90A47827AB4D0882778DE034CFF4C9407848214730268F28841C5AF9FD9D443DCBD51B1C16D6135D90281810088C851492D6CB0FA2C341D7EAF5EC3AEF5D12072FFC260127121B00C2B4F62A7095B96C9075D712BC4C20E5093192722BF7BDDD0203FA5669C8D90B68E97C9979F5FAEBB94CED41510EC4F5C6818C077D1A51D6A4EE64FD5F8AAF326D85F86D92C06119BDEBFE21A526EAE4E9C7ACA877AE7D1BFA5B4266E8FB3A955512C45F1028180627CBEE3C0D76BC96CD4718FCD4DDAF9CC54C5A56808896975DCFFFCE7673F1D6D330D1A0F2655722FC5E8F24F4980A2F63AE17C07E61D814C553FB2DDB9D43E27A2A8067FBCE1253A6333EEBC4F5051A4C364F65CF11C42DCE07AABF59E96DAA7FC6C9296DB1010C405016260FEA122701DFA6ED188A05BDAB3ED4052238728"/>
            <column name="COMMON_KEY" value="*2smXo$2MSdf@133"/>
            <column name="CREATE_TIME" valueComputed="datetime('now')"/>
            <column name="CREATE_BY" value="sys"/>
            <column name="DB_VERSION" value="1"/>
        </insert>
    </changeSet>

    <changeSet id="kcdb_9" author="kochiu" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="user_category"/>
            </not>
        </preConditions>
        <createTable remarks="用户资源分类表" tableName="user_category">
            <column name="CATE_ID" remarks="主键" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="CATE_NAME" remarks="分类名称" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="USER_ID" remarks="用户ID" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="SNO" remarks="序号" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="CREATE_TIME" remarks="创建时间" type="date"/>
            <column name="CREATE_BY" remarks="创建人" type="VARCHAR(20)"/>
            <column name="UPDATE_TIME" remarks="更新时间" type="date"/>
            <column name="UPDATE_BY" remarks="更新人" type="VARCHAR(20)"/>
            <column name="DB_VERSION" remarks="数据版本" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="kcdb_10" author="kochiu" runOnChange="true">
        <preConditions>
            <rowCount expectedRows="0" tableName="user_category"/>
        </preConditions>
        <insert tableName="user_category">
            <column name="CATE_ID" value="1"/>
            <column name="CATE_NAME" value="默认"/>
            <column name="USER_ID" value="1"/>
            <column name="SNO" value="1"/>
            <column name="CREATE_TIME" valueComputed="datetime('now')"/>
            <column name="CREATE_BY" value="sys"/>
            <column name="DB_VERSION" value="1"/>
        </insert>
    </changeSet>

    <changeSet id="kcdb_11" author="kochiu" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="user_resource"/>
            </not>
        </preConditions>
        <createTable remarks="用户资源表" tableName="user_resource">
            <column name="RESOURCE_ID" remarks="主键" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="USER_ID" remarks="用户ID" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="title" remarks="标题" type="VARCHAR(100)"/>
            <column name="description" remarks="描述" type="VARCHAR(500)"/>
            <column name="SOURCE_FILE_NAME" remarks="原文件名" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="RESOURCE_URL" remarks="存储路径" type="VARCHAR(200)">
                <constraints nullable="false"/>
            </column>
            <column name="thumb_url" remarks="缩略图路径" type="VARCHAR(200)"/>
            <column name="deleted" remarks="是否删除" type="INTEGER" defaultValue="0"/>
            <column name="CATE_ID" remarks="分类ID" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
            <column name="resource_type" remarks="资源类型" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="file_ext" remarks="文件扩展名" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="resolution_ratio" remarks="分辨率" type="VARCHAR(200)"/>
            <column name="size" remarks="文件大小" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="is_public" remarks="公开" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="star" remarks="星级" type="INTEGER" defaultValue="0"/>
            <column name="CREATE_TIME" remarks="创建时间" type="date"/>
            <column name="CREATE_BY" remarks="创建人" type="VARCHAR(20)"/>
            <column name="UPDATE_TIME" remarks="更新时间" type="date"/>
            <column name="UPDATE_BY" remarks="更新人" type="VARCHAR(20)"/>
            <column name="DB_VERSION" remarks="数据版本" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- 添加主键自增元数据 -->
        <addAutoIncrement
                tableName="user_resource"
                columnName="RESOURCE_ID"
                columnDataType="INTEGER"
        />
    </changeSet>
</databaseChangeLog>
